--
-- Author: lyx
-- Date: 2018/3/10
-- Time: 15:07
-- 说明：测试
-- 使用方法：
--  call <service addr> exe_file "hotfix/fixtest.lua"
--

local skynet = require "skynet_plus"
local cluster = require "skynet.cluster"
local base = require "base"
local nodefunc = require "nodefunc"
local basefunc = require "basefunc"
require "normal_enum"


require "printfunc"

local DATA = base.DATA
local CMD = base.CMD
local PUBLIC=base.PUBLIC


--[[


SELECT a.player_id ,b.game_id, COUNT(a.player_id) FROM freestyle_race_player_log AS a JOIN freestyle_race_log AS b 
ON b.id = a.match_id 
WHERE 
b.begin_time > "2019-04-09 8:00:00"
AND
b.end_time < "2019-04-09 20:30:00"
AND a.player_id NOT LIKE "robot%"
AND a.score > 0

GROUP BY b.game_id,a.player_id

ORDER BY a.player_id



call freestyle_activity_center_service exe_file "hotfix/fix_ls_activity.lua"
]]

local raw_conf = require "free_activity_lei_sheng"

local activity_configs = {}

local function load_activity_config(_raw_config,_game_id)

	if activity_configs[_game_id] then
		return activity_configs[_game_id]
	end

	local raw_config = basefunc.deepcopy(_raw_config)
	local activity_config = {}

	local cfg = nil
	for i,c in ipairs(raw_config.main) do
		if c.game_id == _game_id then
			cfg = c
			break
		end
	end

	if not cfg then
		print("error : load_activity_config  config is not found ")
		return
	end

	activity_config.max_round = cfg.max_round
	activity_config.name_tag = cfg.name_tag
	activity_config.max_process = cfg.max_process
	
	activity_config.big_award = {}

	local award = {}
	for i,a in ipairs(raw_config.award) do
		local aw = award[a.id] or {}
		award[a.id] = aw
		aw[#aw+1] = a

		if a.is_big == 1 then
			activity_config.big_award[a.id]=true
		end
		a.is_big = nil
		a.id = nil
		a.no = nil
	end

	activity_config.broadcast = {}
	for i,b in ipairs(raw_config.boardcast) do
		activity_config.broadcast[b.id]=b.content
	end
	
	activity_config.award = award



	activity_config.award_id = cfg.award_id

	activity_config.weight = cfg.weight

	activity_config.weight_count = 0

	for i,w in ipairs(cfg.weight) do
		activity_config.weight_count = activity_config.weight_count + w
	end

	activity_configs[_game_id] = activity_config

	-- dump(activity_config,"activity_config+++++++++++++")
end


local function get_config(_game_id)
	
	local cfg = activity_configs[_game_id]

	if not cfg then
		load_activity_config(raw_conf,_game_id)
	end
	
	return activity_configs[_game_id]

end


local function get_player_activity_award(_player_id,_game_id,_cur_process)

	local activity_config = get_config(_game_id)
	
	if not activity_config then
		return nil
	end

	if _cur_process>=activity_config.max_process then

		local weight_count = activity_config.weight_count

		local r = math.random(1,weight_count)

		local ai = 0
		for i,w in ipairs(activity_config.weight) do
			r = r - w
			if r < 1 then
				ai = i
				break
			end
		end
		
		ai = activity_config.award_id[ai]

		return activity_config.award[ai]

	end

end


local function fw(_player_id,_game_id,_cur_process)

	local round = 0

	while true do

		local award = get_player_activity_award(_player_id,_game_id,_cur_process)

		if award then

			round = round + 1

			local cfg = get_config(_game_id)

			_cur_process = _cur_process - cfg.max_process

			if round > cfg.max_round then
				return
			end

			local email = 
			{
				type = "freestyle_activity_award",
				title = "匹配场活动奖励（补发）",
				sender = "系统",
				data = {},
			}

			--发送活动奖励
			email.receiver = _player_id
			email.data = 
			{
				game_id = _game_id,
				activity_id = 1,
				asset_change_data = {
					change_type = ASSET_CHANGE_TYPE.FREESTYLE_ACTIVITY_AWARD,
					change_id = "free_activity_lei_sheng_".._game_id.."_"..round,
				}
			}
			for i,aw in ipairs(award) do
				email.data[aw.asset_type] = aw.value
			end

			skynet.send(DATA.service_config.email_service,"lua","send_email",email)

			if _cur_process - cfg.max_process < 0 then
				return
			end
		else
			return
		end

	end

end


local act_data = 
{
	10104642,2,42,
	101051718,2,9,
	101065264,2,23,
	10109078,1,8,
	1012004,1,17,
	101204291,1,1,
	101240400,2,17,
	101380521,13,1,
	101384612,2,4,
	101384612,1,25,
	101400030,17,3,
	101419718,1,1,
	1014468,25,2,
	101447960,17,1,
	101447960,1,1,
	101464629,17,8,
	101494667,17,3,
	101562528,21,2,
	101570282,1,10,
	1017239,1,66,
	101757632,1,3,
	10180605,14,2,
	101845505,2,10,
	10188269,1,18,
	10188269,2,77,
	101953980,2,1,
	101953980,1,80,
	101995022,2,2,
	102005411,1,1,
	102005411,2,6,
	102018819,1,4,
	102023548,1,1,
	102034440,13,5,
	102047640,1,3,
	102058811,1,45,
	102063823,17,1,
	102065177,17,2,
	102073206,2,7,
	102073291,1,31,
	102076611,1,17,
	102076611,2,8,
	102077306,1,7,
	102077356,1,12,
	102080081,1,1,
	102088113,17,4,
	102090971,17,6,
	102093570,1,24,
	102096863,2,5,
	102097763,13,7,
	102097763,17,2,
	102110503,1,1,
	102129959,17,2,
	102131366,2,6,
	102131468,2,4,
	102131468,13,1,
	102131468,1,6,
	102133398,1,3,
	102136348,1,11,
	102136947,1,1,
	102138198,17,11,
	102149419,17,8,
	102152191,13,1,
	102159945,1,5,
	102175686,17,14,
	102177248,17,1,
	102177898,17,1,
	102177928,17,6,
	102177928,13,1,
	102181251,2,6,
	102181251,1,25,
	102183894,1,5,
	102185801,1,18,
	102186253,13,2,
	102186916,1,3,
	102188231,1,14,
	102189816,1,53,
	102190987,17,21,
	102194732,17,1,
	102194732,13,4,
	102196614,1,2,
	102201242,17,19,
	102215430,1,2,
	102222817,17,13,
	102223069,1,17,
	102224724,2,3,
	102224724,1,13,
	102227220,1,2,
	102227300,1,3,
	102229630,1,2,
	102232068,1,3,
	102232068,2,8,
	102234375,1,7,
	102247339,1,4,
	102254678,1,6,
	102260910,17,21,
	102260910,18,1,
	102261783,1,2,
	102268397,17,3,
	102269079,1,24,
	102284457,18,14,
	102287223,1,2,
	102289091,1,6,
	102291299,1,7,
	102292211,18,20,
	102292211,19,7,
	102292777,17,3,
	102293729,1,10,
	102295988,1,17,
	102296555,17,2,
	102297617,1,3,
	102301258,17,1,
	102305697,1,24,
	102305697,2,1,
	102306024,17,10,
	102306064,17,2,
	102306064,1,11,
	102308836,1,5,
	102314458,17,1,
	102319672,1,5,
	102319829,1,11,
	102320087,13,7,
	102320087,14,44,
	102320087,17,9,
	102320442,18,1,
	102320442,17,10,
	102324800,1,1,
	102328668,1,23,
	102329420,1,1,
	102329520,2,1,
	102330677,1,10,
	102331487,1,7,
	102332567,2,6,
	102332923,2,1,
	102332923,17,3,
	102332923,1,1,
	102334619,1,12,
	102335836,1,3,
	102336170,18,38,
	102336170,17,9,
	102336343,1,1,
	102336867,1,2,
	102337069,2,7,
	102337069,1,40,
	102337927,1,4,
	102337927,17,1,
	102338487,1,1,
	102338633,2,35,
	102338641,1,5,
	102340013,13,8,
	102341204,18,2,
	102346077,17,3,
	102349659,1,4,
	102354762,1,2,
	102358664,1,3,
	102360945,1,3,
	102365442,1,36,
	102368627,2,1,
	102370370,1,16,
	102389710,13,1,
	102390355,13,3,
	102390355,1,47,
	102390379,1,19,
	102390459,1,22,
	102390900,1,6,
	102391374,1,24,
	102391588,1,7,
	102391588,2,1,
	102391903,13,2,
	102392356,1,14,
	102394558,1,7,
	102396566,1,18,
	102396566,2,2,
	102397155,17,2,
	102397155,1,27,
	102397262,1,1,
	102397302,1,2,
	102397332,1,1,
	102397338,1,22,
	102397375,1,8,
	102397797,2,5,
	102397797,1,11,
	102398429,17,3,
	102398940,1,16,
	102399167,1,10,
	102404223,2,1,
	102404223,1,22,
	102412296,13,1,
	102412296,17,10,
	102412743,1,4,
	102416256,17,2,
	102416256,1,17,
	102416816,17,2,
	102417686,14,3,
	102417686,1,2,
	102417686,17,1,
	102422065,1,11,
	102422644,17,2,
	102422961,17,3,
	102423523,2,33,
	102426054,1,29,
	102426054,2,3,
	102426552,17,7,
	102426827,17,1,
	102431717,1,4,
	102431809,17,4,
	102431809,1,72,
	102433109,1,13,
	102434414,18,1,
	102435821,17,34,
	102436015,2,15,
	102436015,1,20,
	102436114,1,1,
	102438954,2,4,
	102440666,18,12,
	102440666,2,18,
	102441002,1,3,
	102441002,17,3,
	102441039,2,25,
	102441145,2,1,
	102441145,17,1,
	102441145,1,10,
	102441204,1,7,
	102441445,2,7,
	102443532,1,1,
	102447301,1,25,
	102447301,2,3,
	102449211,17,11,
	102450579,18,7,
	102450579,17,7,
	102453552,1,2,
	102455635,2,5,
	102456813,17,2,
	102458238,1,23,
	102458238,2,4,
	102462279,1,1,
	102462279,2,1,
	102462725,1,10,
	102462725,2,8,
	102462956,1,6,
	102463031,2,1,
	102463031,1,4,
	102464120,1,2,
	102465333,22,5,
	102466768,2,3,
	102466768,1,1,
	102471778,1,17,
	102471778,2,1,
	102472112,1,1,
	102472779,2,1,
	102474222,17,6,
	102474408,2,1,
	102474408,17,3,
	102474408,1,30,
	102474647,2,5,
	102474746,17,5,
	102476411,17,13,
	102478992,2,1,
	102478992,21,6,
	102478992,1,4,
	102480293,2,1,
	102480293,1,20,
	102481730,13,5,
	102481730,2,1,
	102481730,1,2,
	102481730,17,5,
	102488377,17,2,
	102491267,1,29,
	102491541,2,9,
	102492319,1,7,
	102492889,1,51,
	102492921,1,4,
	102493073,17,3,
	102493208,1,45,
	102493208,2,3,
	102493534,1,10,
	102493560,2,3,
	102494392,1,16,
	102494567,2,39,
	102494567,1,19,
	102494699,1,10,
	102494699,2,6,
	102494876,2,76,
	102494924,17,1,
	102494924,1,10,
	102495146,2,2,
	102495181,1,13,
	102495181,2,57,
	102495209,1,9,
	102495209,2,3,
	102495250,1,13,
	102495250,2,13,
	102495290,1,19,
	102495290,2,22,
	102495309,1,6,
	102495347,1,3,
	102495395,2,7,
	102495400,2,4,
	102495425,1,4,
	102495453,2,6,
	102495501,2,2,
	102495501,1,22,
	102497101,1,1,
	102498069,17,18,
	102498069,18,8,
	102498069,1,1,
	102498069,2,13,
	102500552,17,13,
	102500673,2,6,
	102500941,17,3,
	102501146,1,3,
	102502116,14,4,
	102502733,2,8,
	102502824,1,26,
	102503589,1,7,
	102503660,14,6,
	102504202,17,6,
	102505673,1,8,
	102505732,17,12,
	102505750,2,10,
	102505807,1,4,
	102505941,2,5,
	102506150,1,6,
	102506517,2,17,
	102506968,17,13,
	102507398,1,1,
	102507911,1,12,
	102507922,1,4,
	102508091,17,1,
	102508091,1,5,
	102508098,1,3,
	102508357,2,14,
	102508521,1,4,
	102508533,1,8,
	102508652,1,9,
	102508926,1,2,
	102509277,17,8,
	102509277,1,9,
	102509277,18,28,
	102509277,2,29,
	102509629,1,2,
	102509899,1,44,
	102509899,2,7,
	102510648,1,17,
	102510818,2,9,
	102512166,17,5,
	102512805,1,3,
	102513331,1,6,
	102513403,2,2,
	102513581,1,9,
	102513834,1,3,
	102514772,1,22,
	102516374,1,2,
	102516816,2,1,
	102516816,1,46,
	102517061,1,10,
	102517965,1,5,
	102518099,1,10,
	102519077,1,2,
	102519077,21,13,
	102519077,13,12,
	102519077,14,16,
	102519455,2,2,
	102519455,1,31,
	102520434,17,5,
	102520911,1,5,
	102521103,1,4,
	102521249,17,2,
	102521499,22,6,
	102521774,1,3,
	102522899,1,3,
	102523291,2,10,
	102523291,1,2,
	102524230,17,6,
	102524401,18,9,
	102526016,18,12,
	102526016,3,2,
	102526016,2,10,
	102526016,14,1,
	102526129,1,6,
	102528038,1,1,
	102528519,1,6,
	102529370,1,2,
	102530345,1,29,
	102530576,1,23,
	102531412,1,2,
	102531895,23,26,
	102532081,1,4,
	102532636,17,5,
	102533005,1,10,
	102533844,14,1,
	102534073,14,1,
	102534073,22,3,
	102534689,2,3,
	102535038,17,8,
	102536033,1,1,
	102536579,1,6,
	102536674,1,2,
	102537480,1,19,
	102537665,17,2,
	102537855,1,3,
	102537991,17,2,
	102537998,1,4,
	102538250,2,1,
	102538250,1,13,
	102538420,2,1,
	102538420,1,7,
	102538614,1,5,
	102538965,1,14,
	102539678,2,1,
	102539678,1,20,
	102541863,17,40,
	102541880,1,5,
	102541996,1,1,
	102544318,2,1,
	102544318,1,22,
	102545148,1,8,
	102545595,1,5,
	102547045,1,2,
	102548471,1,2,
	102548811,1,11,
	102548811,17,18,
	102553364,17,1,
	102553426,2,4,
	102553426,1,10,
	102553812,1,18,
	102554726,21,4,
	102554726,2,8,
	102554726,17,1,
	102554726,1,5,
	102555906,2,33,
	102555906,1,22,
	102557007,18,8,
	102558230,1,4,
	102558629,17,4,
	102560326,1,7,
	102560442,17,23,
	102563222,1,3,
	102568198,1,24,
	102568198,17,29,
	102568419,1,5,
	102569070,1,6,
	102572099,19,6,
	102572099,2,2,
	102572675,1,3,
	102572957,1,6,
	102573239,1,56,
	102573357,1,1,
	102573780,1,27,
	102574209,17,8,
	102575262,1,3,
	102575594,1,6,
	102575804,1,5,
	102575845,1,3,
	102576455,17,1,
	102577276,1,31,
	102577948,1,17,
	102578407,17,9,
	102578712,1,1,
	102579231,14,2,
	102580498,1,31,
	102580536,1,1,
	102580688,1,20,
	102580986,1,9,
	102581176,17,1,
	102581176,1,18,
	102581874,1,1,
	102582119,1,5,
	102582140,17,1,
	102582715,1,7,
	102583008,1,14,
	102583320,1,5,
	102583542,1,1,
	102583567,1,16,
	102584130,2,28,
	102584388,1,2,
	102584467,1,9,
	102584529,1,25,
	102584529,2,130,
	102584617,1,22,
	102584617,2,2,
	102584898,1,48,
	102584971,1,5,
	102585197,17,1,
	102585680,2,4,
	102586780,1,7,
	102587103,1,46,
	102587387,1,5,
	102587855,1,4,
	102588083,14,5,
	102588103,2,34,
	102588103,1,6,
	102588201,1,8,
	102588495,1,2,
	102589212,14,5,
	102589496,1,4,
	102589756,2,1,
	102589756,1,25,
	102590109,1,5,
	102590157,1,1,
	102591686,1,2,
	102591686,2,2,
	102591775,1,2,
	102592688,1,9,
	102592929,1,5,
	102592951,1,19,
	102594150,1,10,
	102594395,2,3,
	102594504,1,7,
	102594764,1,11,
	102595002,1,43,
	102595052,1,2,
	102595309,1,4,
	102595467,17,6,
	102595688,1,7,
	102595971,17,1,
	102596248,1,1,
	102596297,1,1,
	102596354,1,5,
	102596565,1,7,
	102597240,1,8,
	102597240,2,5,
	102597637,1,11,
	102598061,1,3,
	102598173,1,2,
	102598336,1,1,
	102598355,1,1,
	102598395,1,3,
	102599395,1,11,
	102599568,1,31,
	102599568,2,5,
	102599740,1,18,
	102600257,2,2,
	102600257,1,17,
	102600453,17,1,
	102600453,1,2,
	102600529,17,3,
	102600560,17,22,
	102601349,1,13,
	102601396,1,6,
	102602179,2,94,
	102602438,13,3,
	102602951,14,4,
	102603746,1,14,
	102603790,2,10,
	102603790,1,29,
	102604091,1,11,
	102604364,1,3,
	102604547,1,1,
	102604547,17,1,
	102604786,1,2,
	102604961,2,28,
	102605669,1,2,
	102606010,1,21,
	102606598,2,1,
	102606598,1,31,
	102606762,1,7,
	102607543,1,22,
	102608213,1,15,
	102608246,2,8,
	102608823,1,4,
	102609202,1,9,
	102610373,2,88,
	102610874,1,2,
	102611557,1,3,
	102611763,1,1,
	102611837,1,33,
	102612713,1,9,
	102613793,1,18,
	102614823,14,2,
	102615709,17,10,
	102615709,18,7,
	102615754,1,4,
	102615772,1,9,
	102615884,13,5,
	102616349,4,63,
	102616349,20,60,
	102616648,1,9,
	102616746,1,8,
	102617139,1,4,
	102617324,17,3,
	102617830,1,7,
	102618449,2,1,
	102618543,17,4,
	102618571,2,6,
	102618922,1,4,
	102619090,1,11,
	102619090,2,2,
	102619755,1,5,
	102619755,2,9,
	102620099,1,1,
	102620188,1,14,
	102620188,2,7,
	102623149,1,13,
	102624837,17,3,
	102625654,13,5,
	102625973,1,17,
	102626068,13,2,
	102626372,17,1,
	102626372,13,2,
	102626395,17,3,
	102628374,1,12,
	102628374,17,6,
	102628452,2,10,
	102628452,1,6,
	102628954,1,29,
	102629048,1,1,
	102630062,2,1,
	102630062,14,6,
	102632937,1,3,
	102632937,2,2,
	102633265,1,1,
	102633307,1,8,
	102633644,1,5,
	102633764,17,2,
	102634225,1,2,
	102634700,1,1,
	102634732,18,6,
	102634732,22,3,
	102634732,17,5,
	102634732,2,12,
	102635185,2,2,
	102635185,22,1,
	102637623,25,7,
	102637879,14,1,
	102637879,17,15,
	102637879,13,24,
	102638108,19,2,
	102638464,14,2,
	102638601,1,2,
	102639136,1,3,
	102639593,14,5,
	102640033,1,10,
	102642295,1,27,
	102642295,2,9,
	102642424,2,5,
	102642424,1,3,
	102642881,1,6,
	102644894,1,6,
	102645843,17,20,
	102646634,14,7,
	102648314,17,3,
	102648465,1,1,
	102649201,17,21,
	102649668,1,2,
	102650262,2,47,
	102650262,1,20,
	102650370,21,6,
	102650508,14,6,
	102651006,1,10,
	102651325,14,5,
	102651742,1,8,
	102651742,2,30,
	102656898,17,5,
	102657081,22,1,
	102657855,1,1,
	102657878,1,8,
	102659970,1,30,
	102660102,2,1,
	102660102,1,25,
	102660914,2,6,
	102661093,1,23,
	102661146,1,1,
	102661821,1,3,
	102662055,13,12,
	102662055,17,2,
	102662307,2,10,
	102662307,1,2,
	102662474,2,30,
	102662671,1,5,
	102663162,1,5,
	102663215,1,6,
	102663758,1,6,
	102663983,17,10,
	102663983,1,4,
	102665437,1,4,
	102665529,1,4,
	102667130,2,7,
	102667130,1,27,
	102667671,1,3,
	102667741,1,6,
	102667969,1,4,
	102669571,17,1,
	102669685,2,42,
	102669685,1,59,
	102670438,2,42,
	102670880,1,2,
	102671379,17,4,
	102671769,13,10,
	102672928,1,27,
	102672928,2,3,
	102673614,2,2,
	102673944,1,3,
	102674119,17,5,
	102674227,1,16,
	102676437,1,5,
	102681876,2,3,
	102682326,1,20,
	102682326,17,12,
	102683091,1,13,
	102683091,2,2,
	102687462,18,18,
	102687462,2,3,
	102687462,1,23,
	102688063,1,36,
	102688339,2,6,
	102688339,18,52,
	102688342,1,21,
	102692296,17,4,
	102695549,1,1,
	102698007,1,5,
	102699180,1,44,
	102699180,2,3,
	102699613,1,14,
	102699785,1,1,
	102700902,17,1,
	102700920,2,2,
	102700920,1,14,
	102701288,1,10,
	102701639,1,5,
	102701662,1,22,
	102702196,17,10,
	102707477,1,10,
	102707731,2,7,
	102708499,1,2,
	102708558,1,9,
	102708592,1,2,
	102709062,1,4,
	102709539,14,4,
	102709797,1,5,
	102709867,1,8,
	102710521,2,16,
	102711102,1,8,
	102711182,1,13,
	102711246,21,6,
	102711958,1,8,
	102712217,1,14,
	102712327,1,25,
	102712349,14,5,
	102712349,13,15,
	102712349,1,5,
	102712613,2,6,
	102712717,1,1,
	102712933,2,10,
	102712933,17,2,
	102712933,1,19,
	102713966,1,3,
	102713983,1,2,
	102714083,1,6,
	102714088,1,1,
	102714258,17,34,
	102714258,18,5,
	102714266,17,10,
	102714266,1,12,
	102714275,2,6,
	102714301,1,13,
	102714309,14,5,
	102714309,22,2,
	102714309,18,1,
	102714313,25,8,
	102714351,17,7,
	102714419,1,7,
	102714419,21,34,
	102714722,17,31,
	102714889,14,12,
	102714896,13,1,
	102714896,1,3,
	102714897,1,9,
	102714904,17,6,
	102715338,1,5,
	102715338,2,34,
	102715340,2,6,
	102715362,1,6,
	102715413,1,3,
	102715653,1,2,
	102715686,2,2,
	102715686,1,6,
	102715702,1,1,
	102715714,1,4,
	102715714,17,10,
	102715714,14,1,
	102715820,1,5,
	102715947,1,33,
	102715993,1,15,
	102716066,1,3,
	102716066,21,8,
	102716219,1,10,
	102716254,1,14,
	102716386,17,47,
	102716386,1,14,
	102716396,1,14,
	102716485,1,2,
	102716598,17,1,
	102716762,15,3,
	102716762,13,8,
	102716762,17,1,
	102716762,14,1,
	102716849,22,5,
	102716858,17,2,
	102716884,1,3,
	102717180,1,5,
	102717312,1,1,
	102717368,17,6,
	102717408,2,4,
	102717408,1,14,
	102717409,17,1,
	102717463,1,3,
	102717521,1,11,
	102717875,1,25,
	102718091,2,42,
	102718328,1,4,
	102718575,17,1,
	102718669,1,7,
	102718774,1,12,
	102719104,1,2,
	102719116,1,2,
	102719273,1,11,
	102719370,1,1,
	102719406,1,9,
	102719837,1,8,
	102719837,2,101,
	102719837,18,2,
	102719978,14,6,
	102720030,2,10,
	102720030,21,6,
	102720030,1,17,
	102720371,1,2,
	102720383,20,6,
	102720383,24,5,
	102720397,17,5,
	102720448,1,3,
	102720461,1,7,
	102720476,1,2,
	102720484,2,4,
	102720692,2,5,
	102721040,1,9,
	102721066,1,14,
	102721066,2,8,
	102721348,2,8,
	102721436,17,4,
	102721516,1,25,
	102721594,13,2,
	102721594,1,73,
	102721594,2,17,
	102721594,21,1,
	102721770,1,3,
	102721818,1,10,
	102721863,1,1,
	102721952,2,1,
	102722029,1,14,
	102722048,1,14,
	102722119,17,9,
	102722127,17,4,
	102722278,2,3,
	102722278,1,17,
	102722670,17,5,
	102723266,1,12,
	102723656,1,29,
	102723972,21,11,
	102724094,17,5,
	102724094,13,3,
	102724364,1,9,
	102724446,1,4,
	102724633,17,13,
	102724746,1,6,
	102725174,17,3,
	102725352,1,25,
	102725511,2,31,
	102725612,2,16,
	102725612,1,29,
	102725720,1,5,
	102725880,1,11,
	102725946,17,4,
	102725953,1,2,
	102725975,1,1,
	102725977,1,2,
	102726114,2,3,
	102726114,1,23,
	102726141,2,13,
	102726141,1,12,
	102726196,2,6,
	102726225,1,11,
	102726364,2,7,
	102726364,1,3,
	102726461,1,3,
	102726707,17,1,
	102726856,2,1,
	102726856,1,18,
	102726861,1,6,
	102727069,17,4,
	102727383,1,11,
	102728300,17,1,
	102729307,1,15,
	102729738,1,8,
	102729869,1,6,
	102729915,1,42,
	102730064,17,2,
	102730254,1,7,
	102730697,17,11,
	102731349,2,8,
	102731365,1,2,
	102731427,1,5,
	102731477,17,63,
	102731477,18,3,
	102731726,17,10,
	102731836,1,4,
	102732028,1,3,
	102732039,2,8,
	102732046,1,18,
	102732052,1,5,
	102732390,1,6,
	102732620,1,2,
	102732680,2,4,
	102732680,1,11,
	102732957,1,3,
	102732983,1,9,
	102733036,1,2,
	102733242,1,3,
	102733311,1,1,
	102733390,17,9,
	102733420,1,2,
	102733603,2,2,
	102733603,1,1,
	102733671,17,2,
	102733795,22,6,
	102733800,1,18,
	102733800,2,1,
	102733913,1,8,
	102733913,2,2,
	102734047,18,1,
	102734047,22,3,
	102734047,23,1,
	102734390,1,8,
	102734450,2,3,
	102734450,1,10,
	102734500,2,11,
	102734500,1,52,
	102734560,2,4,
	102734560,1,26,
	102734681,1,6,
	102734703,2,7,
	102734703,1,46,
	102734724,17,3,
	102734915,1,3,
	102734982,1,3,
	102735037,1,14,
	102735088,17,2,
	102735109,2,1,
	102735109,1,26,
	102735200,17,1,
	102735200,13,4,
	102735280,2,6,
	102735290,1,23,
	102735315,2,3,
	102735315,1,14,
	102735328,1,2,
	102735435,1,4,
	102735495,1,5,
	102735572,1,6,
	102735700,1,2,
	102735734,1,1,
	102735752,1,15,
	102735844,1,5,
	102735943,1,8,
	102735970,1,2,
	102736018,17,11,
	102736080,22,9,
	102736188,1,7,
	102736240,1,4,
	102736247,17,2,
	102736278,1,1,
	102736317,2,31,
	102736317,1,5,
	102736333,1,5,
	102736405,17,14,
	102736502,2,17,
	102736507,1,1,
	102736631,1,17,
	102736631,17,1,
	102736662,1,7,
	102736939,17,3,
	102737126,21,18,
	102737172,17,31,
	102737172,18,1,
	102737172,2,4,
	102737172,1,4,
	102737408,1,4,
	102737408,17,3,
	102737760,17,9,
	102738031,17,4,
	102738031,21,3,
	102738083,17,1,
	102738334,1,10,
	102738420,1,2,
	102738593,21,1,
	102738593,17,29,
	102738613,1,4,
	102738613,17,1,
	102738613,13,4,
	102738927,1,19,
	102738987,1,14,
	102739186,1,3,
	102739196,17,1,
	102739196,21,8,
	102739323,2,1,
	102739323,1,18,
	102739367,17,2,
	102739681,17,11,
	102739685,22,4,
	102739711,17,15,
	102739768,1,10,
	102739839,1,5,
	102739887,1,5,
	102739994,1,3,
	102739994,2,4,
	102740211,1,1,
	102740221,1,20,
	102741175,1,5,
	102741305,1,3,
	102741314,17,9,
	102741472,17,5,
	102741628,17,4,
	102741880,1,3,
	102741880,17,1,
	102742272,1,4,
	102742363,1,15,
	102742502,1,2,
	102742581,1,1,
	102742703,1,3,
	102742784,18,7,
	102742784,2,1,
	102742849,17,4,
	102742898,17,2,
	102742898,18,2,
	102742930,1,8,
	102742930,17,3,
	102742958,1,3,
	102742960,1,33,
	102743667,1,4,
	102743768,17,3,
	102744280,1,3,
	102744295,1,22,
	102744320,1,6,
	102744392,1,2,
	102744419,1,9,
	102744419,2,45,
	102744447,1,5,
	102744447,17,8,
	102744449,17,11,
	102744524,1,16,
	102744880,17,6,
	102744880,13,4,
	102744886,17,2,
	102745278,2,15,
	102745278,1,51,
	102745336,17,1,
	102745452,17,1,
	102745452,1,15,
	102745464,17,10,
	102745534,17,6,
	102745567,1,4,
	102745567,17,14,
	102745624,1,3,
	102745637,2,7,
	102745674,1,4,
	102745675,1,2,
	102745685,1,15,
	102745693,17,1,
	102745696,1,1,
	102745726,1,6,
	102745726,17,4,
	102745734,17,2,
	102745749,1,3,
	102745756,1,18,
	102745779,1,4,
	102745888,1,1,
	102745972,1,2,
	102746034,1,10,
	102746034,17,15,
	102746144,1,1,
	102746210,1,2,
	102746210,21,1,
	102746239,21,4,
	102746301,17,7,
	102746305,1,1,
	102746341,17,2,
	102746341,1,2,
	102746349,1,2,
	102746464,1,4,
	102746494,2,3,
	102746607,17,2,
	102746607,1,6,
	102746618,1,3,
	102746621,1,9,
	102746631,1,6,
	102746705,1,8,
	102746746,13,2,
	102746767,17,3,
	102746767,1,21,
	102746772,2,1,
	102746772,1,18,
	102746778,21,4,
	102746792,1,1,
	102746805,1,15,
	102746814,13,2,
	102746814,17,1,
	102746964,2,1,
	102746964,17,1,
	102746972,1,1,
	102746986,17,1,
	102746996,2,1,
	102746996,1,7,
	102747050,1,3,
	102747126,1,5,
	102747135,1,4,
	102747170,2,3,
	102747174,1,2,
	102747183,17,5,
	102747184,1,13,
	102747184,13,1,
	102747193,17,5,
	102747263,1,1,
	102747274,17,5,
	102747373,1,5,
	102747412,13,5,
	102747570,2,1,
	102747570,1,2,
	102747573,1,6,
	102747661,17,2,
	102747692,1,5,
	102747740,1,2,
	102747772,17,1,
	102747772,1,5,
	102747778,17,16,
	102747792,1,2,
	102747798,1,3,
	102747813,17,1,
	102747822,1,4,
	102747823,17,1,
	102747823,1,3,
	102747838,1,4,
	102747838,17,1,
	102747840,13,2,
	102747840,17,1,
	102747847,1,2,
	102747856,1,4,
	102747875,1,1,
	102747884,1,2,
	102747898,1,4,
	102747898,17,1,
	102747905,1,1,
	102747915,1,8,
	102747923,1,4,
	102747930,1,5,
	102747934,1,1,
	102747943,17,4,
	102747958,17,1,
	102747965,1,3,
	102747970,1,1,
	102747986,17,3,
	102747986,1,2,
	102748004,1,2,
	102748004,2,2,
	102748004,17,1,
	102748014,1,3,
	102748014,2,1,
	102748023,1,3,
	102748031,1,2,
	102748035,1,1,
	102748042,1,1,
	102748057,1,1,
	102748065,17,1,
	102748065,2,1,
	102748065,1,5,
	102748071,1,1,
	102748081,1,3,
	102748081,17,1,
	102748083,1,2,
	102748100,17,3,
	102748100,1,1,
	102748127,21,3,
	102748127,17,20,
	102748136,17,6,
	102748144,1,1,
	102748162,17,3,
	102748162,1,6,
	102748163,1,2,
	102748163,18,3,
	102748163,17,2,
	102748173,1,2,
	102748179,1,1,
	102748183,2,2,
	102748183,1,19,
	102748211,17,1,
	102748211,1,2,
	102748219,17,3,
	102748230,1,1,
	102748237,1,1,
	102748255,1,4,
	102748257,1,1,
	102748260,2,3,
	102748260,18,4,
	102748260,1,1,
	102748269,17,1,
	102748269,1,1,
	102748273,1,2,
	102748273,17,3,
	102748286,1,2,
	102748291,17,1,
	102748291,1,6,
	102748297,1,1,
	102748297,17,3,
	102748302,1,10,
	102748308,17,1,
	102748308,1,4,
	102748311,1,1,
	102748315,1,1,
	102748319,1,3,
	102748326,1,1,
	102748356,1,3,
	102748356,2,6,
	102748370,1,11,
	102748370,17,4,
	102748376,17,2,
	102748376,1,1,
	102748376,14,1,
	102748378,17,2,
	102748390,1,1,
	102748392,13,1,
	102748392,1,1,
	102748402,1,2,
	102748420,1,4,
	102748420,14,1,
	102748420,13,2,
	102748427,1,3,
	102748443,1,3,
	102748443,2,1,
	102748446,1,1,
	102748455,17,1,
	102748455,1,4,
	102748461,1,7,
	102748465,1,5,
	102748465,17,1,
	102748467,1,21,
	102748480,17,1,
	102748480,1,1,
	102748498,2,3,
	102748498,1,6,
	102748505,1,5,
	102748514,1,2,
	102748514,17,1,
	102748526,1,3,
	102748536,1,4,
	102748544,1,1,
	102748548,1,1,
	102748553,1,1,
	102748556,17,1,
	102748565,17,5,
	102748565,1,3,
	102748579,1,4,
	102748579,2,4,
	102748589,1,1,
	102748594,1,3,
	102748615,1,2,
	102748621,1,2,
	102748631,1,3,
	102748637,1,2,
	102748638,1,3,
	102748638,2,4,
	102748648,1,2,
	102748657,1,2,
	102748657,17,1,
	102748690,25,1,
	102748690,17,1,
	102748690,1,3,
	102748698,1,2,
	102748705,1,4,
	102748723,1,3,
	102748730,1,15,
	102748753,1,1,
	102748755,1,1,
	102748755,17,1,
	102748755,2,1,
	102748761,2,1,
	102748761,1,15,
	102748765,1,1,
	102748765,17,1,
	102748771,1,1,
	102748774,1,1,
	102748783,1,6,
	102748784,1,1,
	102748784,2,2,
	102748787,17,3,
	102748791,1,8,
	102748816,17,1,
	102748819,1,1,
	102748829,1,1,
	102748833,1,1,
	102748841,1,4,
	102748844,1,1,
	102748852,1,21,
	102748852,2,14,
	102748862,1,1,
	102748872,1,1,
	102748886,1,1,
	102748887,1,2,
	102748899,1,3,
	102748899,17,1,
	102748899,13,1,
	102748900,1,1,
	102748916,1,1,
	102748924,1,1,
	102748924,17,4,
	102748927,13,2,
	102748927,17,5,
	102748929,1,2,
	102748934,17,4,
	102748939,1,2,
	102748941,1,2,
	102748945,1,2,
	102748945,17,1,
	102748950,1,1,
	102748955,1,1,
	102748956,1,1,
	102748964,1,3,
	102748982,1,1,
	102748997,1,1,
	102749005,17,14,
	102749008,1,10,
	102749014,17,1,
	102749021,1,1,
	102749024,1,1,
	102749029,1,1,
	102749038,1,5,
	102749040,1,1,
	102749042,1,27,
	102749042,2,5,
	102749058,1,2,
	102749066,17,1,
	102749075,17,3,
	102749082,1,1,
	102749086,1,5,
	102749086,2,1,
	102749106,1,1,
	102749110,1,5,
	102749113,13,1,
	102749113,17,1,
	102749113,1,3,
	102749139,17,1,
	102749154,1,1,
	102749156,17,2,
	102749168,1,1,
	102749184,1,1,
	102749190,1,1,
	102749192,1,2,
	102749205,1,1,
	102749208,1,5,
	102749208,17,1,
	102749217,1,1,
	102749244,1,1,
	102749247,1,2,
	102749262,17,2,
	102749281,1,4,
	102749285,1,1,
	102749292,1,1,
	102749293,17,3,
	102749300,17,1,
	102749300,2,5,
	102749300,1,14,
	102749305,17,1,
	102749305,1,3,
	102749314,17,4,
	102749314,1,7,
	102749323,17,21,
	102749363,1,4,
	102749364,1,1,
	102749368,1,5,
	102749384,1,1,
	102749391,1,5,
	102749393,1,1,
	102749401,1,1,
	10346511,1,21,
	1036385,17,9,
	1036385,18,9,
	10381665,1,2,
	10535280,17,11,
	10547519,1,10,
	1059523,2,4,
	1063380,1,1,
	1063380,13,2,
	10662629,1,4,
	10662629,2,2,
	10665133,24,1,
	10667302,24,1,
	10670374,1,7,
	10676292,22,3,
	1071645,18,2,
	10744252,1,1,
	1077679,1,7,
	1079972,1,1
}

return function()
	
	for i=1,#act_data,3 do
		fw(tostring(act_data[i]),act_data[i+1],act_data[i+2])
		skynet.sleep(1)
	end

end